#!/usr/bin/env node

var bcrypt = require('bcrypt'),
	prompt = require('prompt'),
	salt = 10;

console.log(process.argv);
for (var i = 1, len = process.argv.length; i < len; i++) {
	switch (process.argv[i]) {
		case '-s':
		case '--salt':
			if (!/^[0-9]+$/.test(process.argv[i + 1])) {
				throw 'No valid salt length';
			}
			salt = parseInt(process.argv[i], 10);
			continue;
	}
}


prompt.get([{
	name: 'password',
	description: 'Enter password',
	hidden: true
}, {
	name: 'password2',
	description:'Confirm password',
	hidden: true
}], function(err, result) {
	// console.log('Result', result);
	if (result.password === result.password2) {
		console.log(bcrypt.hashSync(result.password, salt));
		process.exit(0);
	}
	else {
		console.log('Failed! The passwords aren\'t equal! Try again');
		process.exit(0);
	}
});


/*rl.question('Enter password: ', function(answer) {
	var pass1 = answer,
		pass2;
	rl.question('Confirm password: ', function(answer) {
		pass2 = answer;

		
	});
});

*/
